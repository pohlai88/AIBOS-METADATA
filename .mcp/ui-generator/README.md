# AIBOS UI Generator MCP Server

> **Generate UI layouts/components from natural language with governance metadata**

This MCP server generates production-ready UI layouts and components from natural language descriptions, enforcing design system rules and providing governance metadata for AI-BOS integration.

---

## Features

### ✅ Natural Language UI Generation
- Generate UI layouts/components from plain English descriptions
- Supports multiple output formats (JSX, TSX, JSON, Markdown)
- Multiple generation modes (wireframe, production, token-only)
- Context-aware generation with design tokens and component library

### ✅ Design System Enforcement
- Uses system prompt from `.mcp/ui-generator/prompt.md` (server-specific, follows architecture)
- Enforces design token compliance
- Respects component library conventions
- Follows AIBOS UI constitution rules

### ✅ Governance & Metadata
- **Governance metadata** - All results tagged with tool ID, domain, category
- Integration-ready for `mdm_tool_registry` and governance workflows
- All responses include `registryContext` for upstream systems

### ✅ Flexible Configuration
- Configurable OpenAI model via `AIBOS_UI_GENERATOR_MODEL` environment variable
- Default model: `gpt-5.1-thinking`
- Temperature control for consistent outputs

---

## MCP Tools

### `generate_ui_layout`

Generates UI layout/component code from a natural language prompt.

**Input:**
```typescript
{
  prompt: string;                    // Natural language description (required)
  format?: "jsx" | "tsx" | "json" | "markdown";  // Default: "tsx"
  mode?: "wireframe" | "production" | "token-only";  // Default: "production"
  context?: object;                  // Optional context (design tokens, theme, etc.)
}
```

**Output:**
```typescript
{
  ok: boolean;
  result: string;                    // Generated UI code/output
  format: string;                    // Output format used
  mode: string;                      // Generation mode used
  registryContext: {
    toolId: "aibos-ui-generator";
    domain: "ui_generation";
    registryTable: "mdm_tool_registry";
  };
}
```

**Example:**
```typescript
const result = await mcp_AIBOS_UI_Generator_generate_ui_layout({
  prompt: "Build a 2-column dashboard with KPIs and a recent activity table",
  format: "tsx",
  mode: "production",
  context: {
    designTokensSource: "aibos-theme",
    componentLibrary: "@aibos/ui",
    tenant: "DLBB"
  }
});
```

---

## Files

- **`server.mjs`** - MCP server implementation
  - Full MCP server with `Server` + `StdioServerTransport`
  - Exposes `generate_ui_layout` tool
  - Includes governance metadata in all responses
  - Uses OpenAI SDK for LLM interactions

- **`prompt.md`** - System prompt source file (Markdown format)
  - **EDIT THIS** - Human-readable, version-controlled
  - Located in server directory for clear ownership

- **`prompt.generated.mjs`** - Auto-generated from `prompt.md`
  - **DO NOT EDIT** - This file is automatically generated
  - Regenerate by running: `pnpm sync-mcp-prompt`

---

## Configuration

### MCP Server Configuration

The server is configured in `.cursor/mcp.json`:

```json
{
  "mcpServers": {
    "aibos-ui-generator": {
      "command": "node",
      "args": [".mcp/ui-generator/server.mjs"]
    }
  }
}
```

### Environment Variables

#### `OPENAI_API_KEY` (Required)

Your OpenAI API key for LLM access.

```bash
export OPENAI_API_KEY="sk-..."
```

#### `AIBOS_UI_GENERATOR_MODEL` (Optional)

Override the default model. Default: `gpt-5.1-thinking`

```bash
export AIBOS_UI_GENERATOR_MODEL="gpt-4o"
```

---

## Usage in Cursor

### Generate UI Layout

```
Generate a dashboard layout with sidebar navigation and main content area
```

### Generate Component

```
Create a user profile card component with avatar, name, and bio
```

### Generate with Context

```
Build a login form using our design tokens and component library
```

---

## Integration with Other MCPs

### Workflow: UI Generation Pipeline

```
1. UI Generator: Generate component from prompt
   ↓
2. React MCP: Validate generated component
   ↓
3. Theme MCP: Validate tokens used
   ↓
4. Component Ready ✅
```

### Example Integration

```typescript
// 1. Generate UI
const generated = await mcp_AIBOS_UI_Generator_generate_ui_layout({
  prompt: "Create a button component with primary and secondary variants",
  format: "tsx",
  mode: "production"
});

// 2. Validate with React MCP
const validation = await mcp_React_validate_react_component({
  filePath: "packages/ui/src/components/button.tsx",
  componentName: "Button"
});

// 3. Validate tokens with Theme MCP
const tokenCheck = await mcp_AIBOS_Theme_validate_tailwind_class({
  className: "bg-primary"
});
```

---

## System Prompt Workflow

1. **Edit the system prompt**: Update `.mcp/ui-generator/prompt.md` with your design system rules
2. **Sync the prompt**: Run `pnpm sync-mcp-prompt` to regenerate `prompt.generated.mjs`
3. **Restart MCP server**: The server will automatically use the updated prompt

**Note:** The prompt file is located in the server directory (`.mcp/ui-generator/prompt.md`) to follow the architecture principle that server-specific files should live with the server.

---

## Dependencies

- `@modelcontextprotocol/sdk` - MCP SDK
- `@ai-sdk/openai` - OpenAI SDK (optional, install if using)
- `ai` - AI SDK types (optional, install if using)

Install with:
```bash
pnpm add -D @modelcontextprotocol/sdk @ai-sdk/openai ai
```

---

## Best Practices

### ✅ Do

- Use descriptive prompts with clear requirements
- Specify `format` and `mode` for consistent outputs
- Provide `context` with design tokens and component library info
- Validate generated code with React MCP and Theme MCP
- Review generated code before committing

### ❌ Don't

- Generate code without validation
- Skip design token compliance checks
- Use generated code in production without review
- Ignore governance metadata in automated workflows

---

## Governance Integration

All generation results include governance metadata for integration with upstream systems:

```typescript
{
  registryContext: {
    toolId: "aibos-ui-generator",
    domain: "ui_generation",
    registryTable: "mdm_tool_registry"
  }
}
```

This allows you to:
- Track UI generation usage and metrics
- Apply governance policies based on tool metadata
- Route results to appropriate dashboards
- Enforce review requirements for generated code

---

## Related Documentation

- [React MCP](../react/README.md) - React component validation
- [Theme MCP](../theme/README.md) - Theme and token validation
- [System Prompt](./prompt.md) - Design system rules
- [MCP Architecture](../ARCHITECTURE.md) - Directory structure guidelines

---

**Version:** 1.0.0  
**Status:** ✅ Production Ready (Pilot)  
**Location:** `.mcp/ui-generator/server.mjs`

